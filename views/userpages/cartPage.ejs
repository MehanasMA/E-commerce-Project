<!doctype html>
<html lang="en">

<head>
	<title>My Cart</title>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />

	<link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
	<link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700,900" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Poppins:400,500,700,900" rel="stylesheet">
	
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!-- Bootstrap core CSS -->
	<link href="vendor/bootstrap/css/bootstrap.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<!-- Bootstrap core CSS -->
	<link href="/css/styles.css" rel="stylesheet">
	<link href="/css/animate.css" rel="stylesheet">
	<link href="/css/owl-carousel.css" rel="stylesheet">
	<link href="/css/lightbox.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
				<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

	<!-- Custom styles for this template -->
</head>

<body>
<header class="header-area header-sticky text-center header-default">
	<div class="header-main-sticky">
		
		<div class="header-main-head">

			<div class="header-main">
				<div class="container">
					<div class="header-left float-left d-flex d-lg-flex d-md-block d-xs-block">

						<div class="currency-wrapper toggle">

						</div>
						<div class="contact">
							<i class="material-icons">phone</i>
							<span>1234567890</span>
						</div>
					</div>
					<div class="header-middle float-lg-left float-md-left float-sm-left float-xs-none">
						<div class="logo">
							<a href="/"><img src="/img/logos/logo.png" alt="NatureCircle"></a>
						</div>
					</div>
					<div class="header-right d-flex d-xs-flex d-sm-flex justify-content-end float-right">
						<div class="search-wrapper">
							<a>
								<i class="material-icons search">search</i>
								<i class="material-icons close">close</i>
							</a>
							<form autocomplete="off" action="/action_page.php" class="search-form">
								<div class="autocomplete" style="width:300px;">
									<input id="myInput" type="text" name="myCountry" placeholder="Search here">
									<button type="button"><i class="material-icons">search</i></button>
								</div>
							</form>
						</div>
						<div class="user-info">
							<button type="button" class="btn">
								<i class="material-icons">perm_identity</i>
							</button>
							<div id="user-dropdown" class="user-menu">
								<ul>


									<li><a href="/myaccount" class="text-capitalize">my account</a></li>


									
									<li> <a class="" href="/logout">Logout</a></li>




									<li><a type="submit" class="modal-view button" data-toggle="modal"
											data-target="#modalRegisterForm">Register</a></li>


									<li><a href="#" class="modal-view button" data-toggle="modal"
											data-target="#modalLoginForm">login</a></li>

								</ul>
							</div>
						</div>
						<div class="cart-wrapper">
							<form action="/cart/cartpage" method="get">

								<button class="btn" type="submit"><a href="/cart/cartpage">
										<i class="material-icons">shopping_cart</i>
									</a>
								</button>
							</form>
							<div id="cart-dropdown" class="cart-menu">
								<ul class="w-100 float-left">


									<!-- <li class="buttons w-100 float-left">
											<form action="/cart/cartpage" method="get">
												<input class="btn pull-left mt_10 btn-primary btn-rounded w-100"
													value="View cart" type="submit">
											</form>
											<form action="/checkout/checkout">
												<input class="btn pull-right mt_10 btn-primary btn-rounded w-100"
													value="Checkout" type="submit">
											</form>
										</li> -->
								</ul>
							</div>
						</div>
						<div>


							<i class="fa-solid fa-heart"></i>
							<span class="material-symbols-outlined"><a href="/wishlist/wishlist">
									favorite</a>
							</span>



						</div>
					</div>
				</div>
			</div>
			<div class="menu">
				<div class="container">
					<!--- Navbar -->
					<nav class="navbar navbar-expand-lg navbar-light d-sm-none d-xs-none d-lg-block navbar-full">

						<!-- Navbar brand -->
						<a class="navbar-brand text-uppercase d-none" href="#">Navbar</a>

						<!-- Collapse button -->
						<button class="navbar-toggler" type="button" data-toggle="collapse"
							data-target="#navbarSupportedContent2" aria-controls="navbarSupportedContent2"
							aria-expanded="false" aria-label="Toggle navigation">
							<span class="navbar-toggler-icon"></span>
						</button>

						<!-- Collapsible content -->
						<div class="collapse navbar-collapse">

							<!-- Links -->
							<ul class="navbar-nav m-auto justify-content-center">
								<li class="nav-item  active">
									<a class="nav-link text-uppercase" href="/">
										Home
										<span class="sr-only">(current)</span> </a>

								</li>
								<!-- <li class="nav-item">
										<a class="nav-link text-uppercase" href="/category">Category</a>

									</li> -->
								<li class="nav-item ">
									<a class="nav-link text-uppercase" href="/about">About us</a>
								</li>


								<li class="nav-item">
									<a class="nav-link text-uppercase" href="/shop">
										Shop
										<span class="sr-only">(current)</span> </a>

								</li>

								<li class="nav-item ">
									<a class="nav-link text-uppercase" href="/contact">Contact us</a>
								</li>
								
							</ul>
							<!-- Links -->
						</div>
						<!-- Collapsible content -->

					</nav>
				</div>
			</div>
		</div>
	</div>
</header>

	<!-- </nav> 																				 -->

	<div class="cart-area table-area pt-110 pb-95 float-left w-100">
		<div class="container">
			<div class="row">
				<% if(cartList.length>0){ %>
				<div class="col-lg-8 col-md-12 col-sm-12 float-left cart-wrapper">
					<div class="table-responsive">
						<table class="table product-table text-center">
							<thead>
									<tr>
										<th class="table-remove text-capitalize">remove</th>
										<th class="table-image text-capitalize">image</th>
										<th class="table-p-name text-capitalize">product</th>
										<th class="table-p-price text-capitalize">price</th>
										<th class="table-p-qty text-capitalize">quantity</th>
										<th class="table-total text-capitalize">total</th>
									</tr>
							</thead>
							<tbody>
								<tr>

									<% cartList.forEach((p)=>{ %>
										<% p.product.forEach((p2)=> { %>
											<td class="table-remove">
												 

												<button type="button" class="btn btn-primary" data-bs-toggle="modal"
													data-bs-target="#exampleModal<%=p.item %>">
													<i class="material-icons">delete</i>
												</button>

											</td>


											<td id="row<%= p.item %>" class="align-middle"><img
													src="<%= p2.image[0].url %> " alt="img" style="width: 50px;">

											</td>
											<td class="align-middle">
												<%= p2.product_name %>
											</td>
											<td class="align-middle "> Rs.<span id="price<%= p.item %>">
													<%= p2.product_price %>
												</span> </td>
											<td class="align-middle">
												<div class="input-group quantity mx-auto" style="width: 100px;">
													<div class="input-group-btn">
														<button type="button" id="minus" onclick="dec('<%= p.item %>')"
															class="btn btn-sm  btn-minus">
															<i class="fa fa-minus"></i>
														</button>
													</div>
													<input type="text" readonly
														class="form-control form-control-sm text-center"
														value="<%= p.itemQuantity %> " id="<%= p.item %>">
													<div class="input-group-btn">
														<button type="button" onclick="inc('<%= p.item %>')"
															class="btn btn-sm  btn-plus" id="plus">
															<i class="fa fa-plus"></i>
														</button>
													</div>
												</div>
											</td>
											<% const total=(p.itemQuantity)*(p2.product_price) %>
												<td class="align-middle ">Rs.<span id="total<%= p.item %>">
														<%= total %>
													</span> </td>
												
								</tr>
								</tr>
								<%})%>
									<%})%>



							</tbody>
						</table>
					</div>
					
				</div>
				<div
					class="table-total-wrapper d-flex justify-content-end pt-60 col-md-12 col-sm-12 col-lg-4 float-left  align-items-center">
					<div class="table-total-content">
						<h2 class="pb-20">Cart totals</h2>
						<div class="table-total-amount">
							<div class="single-total-content d-flex justify-content-between float-left w-100">
								<strong>Subtotal</strong>
								<h6>Rs.<span class="c-total-price" id="subtotal">
									<%= subtotal %>
								</span></h6>
							</div>
							<div class="single-total-content d-flex justify-content-between float-left w-100">
								<strong>Shipping</strong>
								<span class="c-total-price" id="shipping">
									<%= shipping %>
								</span>
							</div>
							<!-- <div class="single-total-content d-flex justify-content-between float-left w-100">
								<strong>Discount</strong>
					         <h6 class="font-weight-medium">Rs.<span id="discount">0</span> </h6>
									
			
							</div> -->
							
							<div class="single-total-content tt-total d-flex justify-content-between float-left w-100">
								<strong>Total</strong>
								<span class="c-total-price " id="grandtotal">
									<%= grandtotal %>
								</span>
							</div>
							<a href="/checkout/checkout/<%= cartList[0]._id %>"
								class="btn btn-primary float-left w-100 text-center">Proceed to
								checkout</a>
						</div>
					</div>
					</div>
              
					<%} else {%>
						<div class=" text-center mt-2 mr-5">
                              <div class="p-5">
								<div class="px-5">
							<h2 class="p-1">
								Your cart is currently empty</h2><br>
							<h4><p class="p-5"> Before proceed to checkout you must add some products to your shopping cart. You will
								find a lot of interesting
								products on our "Shop" page.</p></h4>

								<button class="btn btn-primary p-2 px-3"><a href="/shop">Shop Now</a></button>
							<%}%>
							</div>
							</div>
						</div>
				
			</div>

		</div>
	</div>
	<!-- Footer -->

		</div>
	</div>
	<footer class="page-footer mt-5 font-small footer-default">
		<div class="container-fluid">
		<div class="container-fluid text-center text-md-left">
			<div class="row">
				<div class="col-md-2 footer-cms footer-column">
					<div class="ttcmsfooter">
						<div class="footer-logo"><img src="/img/logos/footer-logo.png" alt="footer-logo"></div>
						<div class="footer-desc">At vero eos et accusamus et iusto odio dignissimos ducimus, duis
							faucibus enim vitae</div>
					</div>
				</div>
				<div class="col-md-2 footer-column">
					<div class="title">
						<a href="#company" class="font-weight-normal text-capitalize mb-10" data-toggle="collapse"
							aria-expanded="false">company</a>
					</div>
					<ul id="company" class="list-unstyled collapse">
						<li>
							<a href="#">search</a>
						</li>
						<li>
							<a href="#">New Products</a>
						</li>
						<li>
							<a href="category.html">Best Collection</a>
						</li>
						<li>
							<a href="wishlist.html">wishlist</a>
						</li>
					</ul>
				</div>
				<div class="col-md-2 footer-column">
					<div class="title">
						<a href="#products" class="font-weight-normal text-capitalize mb-10" data-toggle="collapse"
							aria-expanded="false">products</a>
					</div>
					<ul id="products" class="list-unstyled collapse">
						<li>
							<a href="blog-details.html">blog</a>
						</li>
						<li>
							<a href="about-us.html">about us</a>
						</li>
						<li>
							<a href="contact-us.html">contact us</a>
						</li>
						<li>
							<a href="my-account.html">my account</a>
						</li>
					</ul>

				</div>
				<div class="col-md-2 footer-column">
					<div class="title">
						<a href="#account" class="font-weight-normal text-capitalize mb-10" data-toggle="collapse"
							aria-expanded="false">your account</a>
					</div>
					<ul id="account" class="list-unstyled collapse">
						<li>
							<a href="blog-details.html">personal info</a>
						</li>
						<li>
							<a href="#">orders</a>
						</li>
						<li>
							<a href="contact-us.html">addresses</a>
						</li>
						<li>
							<a href="my-account.html">my wishlists</a>
						</li>
					</ul>

				</div>
				<div class="col-md-2 footer-column">
					<div class="title">
						<a href="#information" class="font-weight-normal text-capitalize mb-10" data-toggle="collapse"
							aria-expanded="false">store information</a>
					</div>
					<ul id="information" class="list-unstyled collapse">
						<li class="contact-detail links">
							<span class="address">
								<span class="icon"><i class="material-icons">location_on</i></span>
								<span class="data"> 4030, Central Bazzar, opp. Varachha Police Station, Varachha Main
									Road, Surat, Gujarat 395006, India</span> </span>
						</li>
						<li class="links">
							<span class="contact">
								<span class="icon"><i class="material-icons">phone</i></span>
								<span class="data"><a href="tel:(99)55669999">+ (99) 55-669-999</a></span> </span>
						</li>
						<li class="links">
							<span class="email">
								<span class="icon"><i class="material-icons">email</i></span>
								<span class="data"><a href="mailto:demo.store@gmail.com">demo.store@gmail.com</a></span>
							</span>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!-- Copyright -->
		<div class="footer-bottom-wrap">
			<div class="container">
				<div class="row">
					<div class="footer-copyright text-center py-3">
						© 2019 - Boostrap theme by store™
					</div>
				</div>
			</div>
		</div>
		<a href="#" id="goToTop" title="Back to top" class="btn-primary"><i
				class="material-icons arrow-up">keyboard_arrow_up</i></a>

</div>
	</footer>
	<!-- Footer -->

	




	<% cartList.forEach((p)=>{ %>
		<% p.product.forEach((p2)=> { %>
			<div class="modal fade" id="exampleModal<%= p.item %>" tabindex="-1" role="dialog"
				aria-labelledby="exampleModalLabel" aria-hidden="true">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title" id="exampleModalLabel">Remove Item</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body">
							Do you want remove this Item from Cart ..?
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
							<button type="button" onclick="itemDel('<%= p.item %>')" class="btn btn-danger"
								data-bs-dismiss="modal">
								Delete</button>
						</div>
					</div>
				</div>
			</div>
			<% }) %>
				<% }) %>



					<!-- Bootstrap core JavaScript
    ================================================== -->
					<!-- Placed at the end of the document so the pages load faster -->
					<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
						integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
						crossorigin="anonymous"></script>
					<script src="js/jquery.min.js"></script>
					<script src="js/bootstrap.min.js"></script>
					<script src="js/owl.carousel.min.js"></script>
					<script src="js/custom.js"></script>
					<script src="js/parallax.js"></script>
					<script src="js/lightbox-2.6.min.js"></script>
					<script src="js/ResizeSensor.min.js"></script>
					<script src="js/theia-sticky-sidebar.min.js"></script>
					<script src="js/inview.js"></script>
					<script src="js/cookiealert.js"></script>
					<script src="js/jquery.countdown.min.js"></script>
					<script src="js/masonry.pkgd.min.js"></script>
					<script src="js/imagesloaded.pkgd.min.js"></script>
					<script src="js/jquery.zoom.min.js"></script>
					<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
						integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
						crossorigin="anonymous"></script>

					<!--Start of Tawk.to Script-->
					<script type="text/javascript">
						var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
						(function () {
							var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
							s1.async = true;
							s1.src = 'https://embed.tawk.to/5ac1aabb4b401e45400e4197/default';
							s1.charset = 'UTF-8';
							s1.setAttribute('crossorigin', '*');
							s0.parentNode.insertBefore(s1, s0);
						})();
					</script>

					<script>
					function inc(id) {
						
						// let count = document.getElementById(id).value
						let price = document.getElementById('price' + id).innerHTML
						fetch('/cart/itemInc/' + id, {
							method: 'post',
							headers: {
								'Content-type': 'application/json',
							},
							body: JSON.stringify({ hai: "ok" })
							
						})
						.then(res => res.json())
						.then(data => {
							document.getElementById(id).value++
							document.getElementById('total' + id).innerHTML = parseInt(price) * parseInt(document.getElementById(id).value)
							
							document.getElementById('subtotal').innerHTML = parseInt(document.getElementById('subtotal').innerHTML) + parseInt(document.getElementById('price' + id).innerHTML)
						
							document.getElementById('grandtotal').innerHTML = parseInt(document.getElementById('subtotal').innerHTML) + parseInt(document.getElementById('shipping').innerHTML)
						})
					}

					function dec(id) {
							let price = document.getElementById('price' + id).innerHTML
							let count = document.getElementById(id).value
							if (count > 1) {
							
								fetch('/cart/itemDec/' + id, {
									method: 'post',
									headers: {
										'Content-type': 'application/json',
									},
									body: JSON.stringify({ hai: "jhj" })
								})
									.then(res => res.json())
									.then(data => {
										document.getElementById(id).value--
										document.getElementById('total' + id).innerHTML = parseInt(price) * parseInt(document.getElementById(id).value)
										document.getElementById('subtotal').innerHTML = parseInt(document.getElementById('subtotal').innerHTML) - parseInt(document.getElementById('price' + id).innerHTML)
										document.getElementById('grandtotal').innerHTML = parseInt(document.getElementById('subtotal').innerHTML) + parseInt(document.getElementById('shipping').innerHTML) 
									})
							}
					}


					function itemDel(id) {
                         console.log(id);
						let price = document.getElementById('price' + id).innerHTML
						let count = document.getElementById(id).value
						let row = document.getElementById('row' + id)

						fetch('/cart/itemDelete/' + id, {
							method: 'put',
							headers: {
								'Content-type': 'application/json',
							},
							body: JSON.stringify({ hai: "jhj" })
						})
							.then(res => res.json())
							.then(data => {
								document.getElementById('subtotal').innerHTML = parseInt(document.getElementById('subtotal').innerHTML) - parseInt(document.getElementById('total' + id).innerHTML)
								document.getElementById('grandtotal').innerHTML = parseInt(document.getElementById('subtotal').innerHTML) + parseInt(document.getElementById('shipping').innerHTML) 
								row.remove()
								success: location.reload()
							})
					}

               
				</script> 
					<!--End of Tawk.to Script-->

</body>

</html>